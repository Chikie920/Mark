# 灰色预测模型



**根据少量的数据(最少4个)，对原始数据进行累加，得到近似指数规律的模型**

**优点：数据量少、精度高**

**缺点：只适合中短期预测、只适合指数增长预测**



## GM(1, 1)模型

一阶微分方程，只含有一个变量的灰色模型



**例：某国2009-2018的人口数**

| 2009   | 2010   | 2011   | 2012   | 2013   | 2014   | 2015   | 2016   | 2017   | 2018   |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| 133126 | 133770 | 134413 | 135069 | 135738 | 136427 | 137122 | 137866 | 138639 | 139538 |

$$
设原人口序列为\space X^{(0)}
$$

$$
则\space X^{(0)} = \{X^{(0)}{(1)}, X^{(0)}{(2)}....X^{(0)}{(n)}\}
\\其中X^{(0)}{(1)}为2009年对应的人口
$$

使用公式生成累加序列
$$
X^{(1)}{(k)} = \sum_{i=1}^kX^{(0)}{(i)}
\\X^{(1)} = \{X^{(0)}{(1)}, X^{(0)}{(1)}+X^{(0)}{(2)},\space ....\space, X^{(0)}{(1)}+...+X^{(0)}{(n)}\}
$$
即第二个序列的每个元素(第一个元素等于原值)，等于**其序列**前面一个元素加上**原序列**当前元素值
$$
按照公式\\
Z^{(1)}(k)=\frac{1}{2}*(Z^{(1)}(k)+Z^{(1)}(k-1))\space,k\in[2,n]\\
得到X^{(1)}的均值生成序列Z^{(1)}\\
Z^{(1)} = \{Z^{(1)}{(2)}, Z^{(1)}{(3)}....Z^{(1)}{(n)}\}\\
注意：Z^{(1)}序列的元素是从第二个开始的，比原序列少第一个元素
$$


### **GM(1, 1)模型建立与求解**

#### 模型建立

$$
预估值\space\widehat{X}^{(1)}(k) = ({X}^{(0)}(1)-\frac{u}{a})*e^{-a*(k-k_0)}+\frac{u}{a}\\
\widehat{X}^{(1)}(k)为k年的估计值，k为k年,k_0为2009，{X}^{(0)}(1)为初始年人数
$$

其中
$$
\widehat{a} = [a, u]^T\\
由最小二乘法\space\space\widehat{a} = (B^T*B)^{-1}*B^T*Y_n\\\\
B = \begin{bmatrix} -Z^{(1)}{(2)} & 1 \\ -Z^{(1)}{(3)} & 1 \\ -Z^{(1)}{(4)} & 1 \\ ... & ... \\ -Z^{(1)}{(n)} & 1 \end{bmatrix}\\
Y_n = [X^{(0)}{(2)},X^{(0)}{(3)},...X^{(0)}{(n)}]^T\\
最终可以求得a与u的值，进行带入得到方程
$$



**建立模型**

![image-20220316190655932](https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220316190655932.png)

其中`k`为预测时间相对于起始时间之差，最终得出的预测结果为累加的值，需要求序列差分得到还原后的值



#### 模型检验

能够进行灰色预测的必要条件是需要进行**极比检验**

为了保证不在对模型进行一番求解后检验不通过，可以在建立模型前对数据进行极比检验

使用公式
$$
\lambda(k)=\frac{X^{(0)}(k-1)}{X^{(0)}(k)},k=2, 3,...,n
$$
如果所有*λ(k)*都落入可容覆盖
$$
\Theta = (e^{-\frac{2}{n+1}}, e^{-\frac{2}{n+2}})内
$$
则可以进行灰色预测，否则需要对数据序列进行变换，加上适当常数C使其落入覆盖内，或者使用其他模型



**检验预测值**

1. 残差检验
2. 极比差检验



**残差检验公式**

<img src="https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220116125515320.png" alt="image-20220116125515320" style="zoom:80%;" />



**极比差检验**

<img src="https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220116125536327.png" alt="image-20220116125536327" style="zoom:80%;" />





#### 注意

模型求出的预测值为累加的预测，需要还原



## 模型引入

`GM(1, 1)`模型适用于具有较强指数规律的序列，只能描述单调的变化过程，对于非单调的摆动发展序列或有饱和的S形序列，可以考虑建立`GM(2, 1)`或`DGM`或`Verhulst`模型



## GM(2，1)模型

和GM(1, 1)相同，生成累加序列
$$
{X}^{(1)}
$$
还要生成一个累减序列
$$
a^{1}{X}^{(0)} = \{a^{1}{X}^{(0)}(2), a^{1}{X}^{(0)}(3),...,a^{1}{X}^{(0)}(n)\}\\
 = \{{X}^{(0)}(2)-{X}^{(0)}(1), {X}^{(0)}(3)-{X}^{(0)}(2),...,{X}^{(0)}(n)-{X}^{(0)}(n-1)\}\\
\\即\space a^{1}{X}^{(0)}(k) = {X}^{(0)}(2)-{X}^{(0)}(k-1), k = 2, 3, 4,...,n
$$
和均值序列
$$
{Z}^{(1)}
$$
![image-20220316192838404](https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220316192838404.png)



**得到GM(2, 1)模型**
$$
a^{1}{X}^{(0)}(k) + a_1{X}^{(0)}(k)+a_2{Z}^{(1)}(k) = b
$$
**并得到白化模型**

![image-20220116132651897](https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220116132651897.png)

<img src="https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220116132319302.png" alt="image-20220116132319302" style="zoom:80%;" />

**利用最小二乘法求得参数，带入到白化方程得到累加生成序列的方程，最后求解并还原**



## DGM(2, 1)模型

**同样生成递增与递减序列**



其时间响应方程为

![image-20220316195247014](https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220316195247014.png)



模型求解

<img src="https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220116133951883.png" alt="image-20220116133951883" style="zoom:80%;" />

得到参数，建立模型，最后估计值并还原，检验



## 灰色Verhulst预测模型

**Verhulst模型主要用来描述具有饱和状态的过程，即S形过程，常用于人口预测、生物生长、繁殖预测及产品经济寿命预测等**



其时间响应方程为

![image-20220316195419995](https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220316195419995.png)



同样生成递增与均值序列

<img src="https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220116134924362.png" alt="image-20220116134924362" style="zoom:80%;" />

<img src="https://raw.githubusercontent.com/Chikie920/Mark/main/Sources/images_math/image-20220116134945207.png" alt="image-20220116134945207" style="zoom:80%;" />

求得参数，带入白化方程求得时间序列，得到估计值并还原，检验

