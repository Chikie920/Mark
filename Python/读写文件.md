## 9.1 - 文件与文件路径

- `Windows`以倒斜杠 `\` 作为文件分隔符

- `macOS `和`Linux`以正斜杠 `/`作为文件分隔符

- `Windows`与`macOS`的文件夹与文件名不区分大小写，而`Linux`上区分



### 9.1.1 - Windows操作系统上的倒斜杠以及macOS和Linux上的正斜杠

要想做到路径的操作适应各个平台，可以使用`pathlib`模块的`Path()`函数

其接收文件字符串，返回合适的路径字符串

```python
from pathlib import Path #从模块中引入该函数

path_windows = Path('span', 'bacon', 'eggs')
print(path_windows)

'''
span\bacon\eggs
'''
```

**在`Windows`平台下，使用`Path()`函数返回一个`WindowsPath`对象，Linux下返回`PosixPath`对象**



### 9.1.2 - 使用/运算符连接路径

`/`运算符也可以组合`Path`对象和字符串，但是**运算符两侧必须至少有一个Path对象**

```python
from pathlib import Path #从模块中引入该函数

path_windows = Path('span') / 'bacon' / 'eggs'
'''
python的运算是从左往右的，Path('span') / 'bacon'返回一个Path对象再进行运算
'''
print(path_windows)

'''
span\bacon\eggs
'''
```



### 9.1.3 - 当前工作目录

使用 `Path.cwd()`函数获取当前目录字符串，并可以利用 `os.chdir()`函数改变路径，需要引入 `os`模块



### 9.1.5 - 绝对路径与相对路径

路径字符串为完整的就是绝对路径，相对路径是相对当前工作目录的

`.\`表示当前文件夹

`..\`表示父文件夹



### 9.1.6 - 用os.makedirs()创建新文件夹

**注意：一般使用Windows路径时都需要加上双倒斜杠，因为单倒斜杠为一个转义字符**

```python
from pathlib import Path #从模块中引入该函数
import os

print(Path.cwd()) #输出当前目录
os.chdir('C:\\Users\\Mirai\\Desktop\\Documents') #切换目录
path_now = Path.cwd() #获取当前目录
print(path_now)
print(os.listdir(path_now)) #输出列出当前目录的所有文件名的字符串列表
os.makedirs('C:\\Users\\Mirai\\Desktop\\Documents\\python') #创建文件夹
print(os.listdir(path_now))

'''
C:\Users\Mirai\Desktop\Work\Local_Space\Python
C:\Users\Mirai\Desktop\Documents
['password.txt', 'student.jpg', '其他', '博客文件备份', '工具', '数学建模', '资料']
['password.txt', 'python', 'student.jpg', '其他', '博客文件备份', '工具', '数学建模', '资料']
'''
```

**`makedirs()`函数会创建所有必要的中间文件夹**



### 9.1.7 - 处理绝对路径和相对路径

`pathlib`模块提供`is_absolute()`方法用于检查给定路径是否为绝对路径，是则返回`True`

```python
from pathlib import Path
path_windows = Path.cwd() / Path('my/path')
print(path_windows.is_absolute())

'''
True
'''
```



- `os.path.abspath(path)` 返回绝对路径
- `os.path.isabs(path)` 为绝对路径返回`True`
- `os.path.relpath(path, start)` 返回从开始路径到`path`的相对路径字符串，没有提供开始路径以当前路径作为参数



### 9.1.8 - 取得文件路径得各部分

- 锚点 `anchor` 根文件夹
- 驱动器 `drive` 表示物理硬盘或U盘
- 父文件夹 `parent` 包含该文件的文件夹
- 文件名 `name` 由主干名 `stem` 和 后缀 `suffix`构成

```python
from pathlib import Path
path_now = Path('C:/User/AI/spam.txt')
print('%s\n%s\n%s\n%s\n%s\n%s' % (path_now.anchor, path_now.drive, path_now.parent, path_now.name, path_now.stem, path_now.suffix))

'''
C:\
C:
C:\User\AI
spam.txt
spam
.txt
'''
```



### 9.1.9 -  查看文件大小和文件夹内容

- `os.path.getsize(path)` 返回`path`参数中文件的字节数
- `os.listdir(path)` 返回文件内文件名字的字符串列表

```python
from pathlib import Path
import os

path_now = Path.cwd()
print(os.listdir(path_now))
print(os.path.getsize(path_now / 'test.py'))

'''
['test.py']
135
'''
```



### 9.1.10 - 使用通配符模式修改文件列表

要处理特定文件，`glob()`方法比`listdir()`简单，需要把返回值传递给`list()`

```python
from pathlib import Path
import os

path_now = Path.cwd()
print(list(path_now.glob('*.py')))

'''
[WindowsPath('C:/Users/Mirai/Desktop/Work/Local_Space/Python/test.py')]
'''
```



### 9.1.11 - 检查路径的有效性

- `exists()` 路径存在，返回`True`
- `is_file()` 路径存在且是文件，返回`True`
- `is_dir()` 路径存在且是文件夹，返回`True`



## 9.2 - 文件读写过程

`pathlib`模块的`read_text()`方法返回文本所有内容的字符串，`write_text()`方法创建一个新的文本文件或覆盖原有文件

```python
import pathlib

path_now = pathlib.Path.cwd() / 'file.txt'
print(path_now.read_text())
path_now.write_text('Hello World!')
print(path_now.read_text())

'''
hello
Hello World!
'''
```



### 9.2.1 - 用open()函数打开文件

需要传入文件路径，返回一个`File`对象

```python
from pathlib import Path

path_now = open(Path.cwd() / 'file.txt')
```



**打开模式**

| t       | 文本模式 (默认)。                                            |
| ------- | ------------------------------------------------------------ |
| **x**   | **写模式，新建一个文件，如果该文件已存在则会报错。**         |
| **b**   | **二进制模式。**                                             |
| **+**   | **打开一个文件进行更新(可读可写)。**                         |
| **U**   | **通用换行模式（不推荐）。**                                 |
| **r**   | **以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。** |
| **rb**  | **以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。一般用于非文本文件如图片等。** |
| **r+**  | **打开一个文件用于读写。文件指针将会放在文件的开头。**       |
| **rb+** | **以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。一般用于非文本文件如图片等。** |
| **w**   | **打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。** |
| **wb**  | **以二进制格式打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。** |
| **w+**  | **打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。** |
| **wb+** | **以二进制格式打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。** |
| **a**   | **打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。** |
| **ab**  | **以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。** |
| **a+**  | **打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。** |
| **ab+** | **以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。** |



### 9.2.2 - 读取文件内容

使用`File对象`的`read()`方法

`readlines()`方法返回所有内容的字符串列表，每个字符串都以换行符结束

```python
from pathlib import Path

path_now = open(Path.cwd() / 'test.py')
print(path_now.read())

'''
from pathlib import Path

path_now = open(Path.cwd() / 'test.py')
print(path_now.read())
'''
```



### 9.2.3 - 写入文件

`write()` 方法写入文件，接收要写入的值

**写入模式**

- `w` 内容将覆盖原文件内容
- `a` 添加模式，不覆盖原内容

```python
from pathlib import Path

path_now = open(Path.cwd() / 'file.txt') #默认文本模式
print(path_now.read())
path_now = open(Path.cwd() / 'file.txt', 'w') #写入模式
path_now.write('你好 世界!')
path_now = open(Path.cwd() / 'file.txt')
print(path_now.read())
path_now = open(Path.cwd() / 'file.txt', 'a') #添加模式
path_now.write('Helow World!')
path_now = open(Path.cwd() / 'file.txt')
print(path_now.read())
```



## 9.3 - 用shelve模块保存变量

利用该模块，可以将变量储存到二进制`shelf`文件中，这样程序下一次可以加载它们

```python
import shelve

data = shelve.open('mydata') #指定要存储的文件名
cats = ['Zophie', 'Pooka', 'Simon']
data['cats'] = cats
data.close()
```

`data['cats']`里的`cats`相当于键，而`cats`列表为值，形成键-值对

执行成功后会生成三个文件 `mydata.bak`、`mydata.dat`、`mydata.dir`



**打开shelf文件**

shelf文件不必用读、写模式打开，它们为二进制文件，能读能写

```python
import shelve

data = shelve.open('mydata')
print(list(data.keys()))
print(list(data.values()))
print(data['cats'])
data.close()

'''
['cats']
[['Zophie', 'Pooka', 'Simon']]
['Zophie', 'Pooka', 'Simon']
'''
```

